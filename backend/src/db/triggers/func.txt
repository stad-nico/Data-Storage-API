### get upmost dirname
DELIMITER //

DROP FUNCTION IF EXISTS GET_UPMOST_DIRNAME;

CREATE FUNCTION GET_UPMOST_DIRNAME(path VARCHAR(255)) RETURNS VARCHAR(255) 
DETERMINISTIC BEGIN
	IF path = "" THEN 
		RETURN CAST(NULL AS VARCHAR(255));
	END IF;
	
	IF LOCATE("/", PATH) = 0 THEN
		RETURN path;
	END IF;

	RETURN SUBSTR(path, 1, LOCATE("/", path) - 1);
END//

DELIMITER ;

### get path after 
DELIMITER //

DROP FUNCTION IF EXISTS GET_PATH_AFTER_UPMOST_DIRNAME;

CREATE FUNCTION GET_PATH_AFTER_UPMOST_DIRNAME(path VARCHAR(255)) RETURNS VARCHAR(255) 
DETERMINISTIC BEGIN
	RETURN INSERT(path, LOCATE(GET_UPMOST_DIRNAME(path), path), CHAR_LENGTH(GET_UPMOST_DIRNAME(PATH)) + 1, '');
END//

DELIMITER ;
