### get upmost dirname
DELIMITER //

DROP FUNCTION IF EXISTS GET_UPMOST_DIRNAME;

CREATE FUNCTION GET_UPMOST_DIRNAME(path VARCHAR(255)) RETURNS VARCHAR(255) 
DETERMINISTIC BEGIN
	RETURN SUBSTR(path, 1, LOCATE("/", path) - 1);
END//

DELIMITER ;

### get path after 
DELIMITER //

DROP FUNCTION IF EXISTS GET_PATH_AFTER_UPMOST_DIRNAME;

CREATE FUNCTION GET_PATH_AFTER_UPMOST_DIRNAME(path VARCHAR(255)) RETURNS VARCHAR(255) 
DETERMINISTIC BEGIN
	RETURN SUBSTR(path, IF(LOCATE("/", path) + 1 > 1, LOCATE("/", path) + 1, LENGTH(path) + 1));
END//

DELIMITER ;
